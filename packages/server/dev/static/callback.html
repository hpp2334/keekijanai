<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Callback</title>
  <script src="./util.js"></script>
</head>
<body>
  <span>result: <span id="url-result"></span></span>
  <div>Redirect to /oauth2 after 3 seconds</div>
  <script>
    (() => {
      var url = new URL(window.location.href);
      $('#url-result').innerText = url.search;

      var jwt = url.searchParams.get('jwt');
      var maxAge = url.searchParams.get('maxAge');

      localStorage.setItem('keekijanai-jwt', JSON.stringify({ jwt, expire: maxAge + Date.now() }));
      setTimeout(() => {
        window.location = '/oauth2.html';
      }, 3000)
    })()
  </script>
</body>
</html>